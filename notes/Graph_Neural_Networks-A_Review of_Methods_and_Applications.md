# 图神经网络

> 在许多领域中，深度学习的成功部分归因于快速发展的计算资源（如GPU）和大量训练数据的可用性，部分归因于深度学习从欧氏空间数据中提取潜在表示的有效性。
> 图是一种结构化数据，它由一系列的对象（nodes）和关系类型（edges）组成；具有局部连接的特点。

## 0x0 图嵌入

+ 图神经网络的研究与图嵌入(或网络嵌入)密切相关
+ 图嵌入旨在通过保留图的网络拓扑结构和节点内容信息，将图中顶点表示为低维向量空间，以便使用简单的机器学习算法
+ 许多图嵌入算法通常是无监督的算法，它们大致可划分为三类，即矩阵分解、随机游走和深度学习方法。其中图嵌入的深度学习方法主要包括基于图自动编码器的算法（如 DNGR和SDNE）和无监督训练的图卷积神经网络（如GraphSage）。

## 0x1 GNN的分类

> 划分为五大类别，分别是：图卷积网络（Graph Convolution Networks，GCN）、 图注意力网络（Graph Attention Networks）、图自编码器（ Graph Autoencoders）、图生成网络（ Graph Generative Networks） 和图时空网络（Graph Spatial-temporal Networks）
> 每个节点的定义是由该节点的特征和相关节点来共同表示的。通过一个被所有节点共享的局部转化函数f根据输入的领域信息，来更新节点v的状态h(向量化表示)。再通过一个局部输出函数g产生节点的输出。训练过程即学习出函数f和g，通过基于梯度下降算法优化loss信息。

### 图卷积网络（Graph Convolution Networks，GCN）

> 近年来空间模型越来越受到关注

+ 基于频谱

  + 图被假定为无向图，无向图的一种鲁棒数学表示是正则化图拉普拉斯矩阵，正则化图拉普拉斯矩阵具有实对称半正定的性质，该矩阵的特征向量构成一组正交基。 将输入图信号（由图的各个节点的N维特征向量组成）投影到正交空间，即对图X的傅里叶变换。在变换中加入滤波器g，即可进行图卷积行为。滤波器的不同将产生不同的模式。

    其中使用的是归一化之后的邻接矩阵

  + 缺点：

    + 需要将整个图加载到内存中以执行图卷积，在处理大型图时是不高效的；
    + 模型假定图为一个固定的图，很难在图中添加新的节点；
    + 仅限于在无向图上工作，有向图上的拉普拉斯矩阵没有明确的定义，有向图转换为无向图则部分信息将丢失。

+ 基于空间

  + 将图像与图关联起来，每个像素代表一个节点，每个像素直接连接到其附近的像素。通过一个3×3的窗口，每个节点的邻域是其周围的8个像素，对该3×3窗口应用一个滤波器。
  + 有潜力处理大型图，当相邻节点数量增加时，可以引入采样技术来提高效率。在每个节点本地执行图卷积，可以轻松地在不同的位置和结构之间共享权重。



任何一个图卷积层都可以写成一个非线性函数,需要对邻接矩阵A添加自传播能力（节点自身的信息传递）和归一化效果（避免单边在讨论时的权重相差较大），自传播采用D（度矩阵）与A的差，并使用D的开方后的逆矩阵进行归一化。



### 图注意力网络（Graph Attention Networks）

> 注意力机制如今已经被广泛地应用到了基于序列的任务中，它的优点是能够放大数据中最重要的部分的影响。

+ 在聚集特征信息时将注意力权重分配给不同的邻居节点，利用注意力函数，自适应地控制相邻节点j对节点i的贡献
+ 根据注意力权重将多个模型集合起来
+ 使用注意力权重引导随机行走

### 图自编码器（ Graph Autoencoders）

+ 其目的是利用神经网络结构将图的顶点表示为低维向量。


### 图时空网络（Graph Spatial-temporal Networks）

+ 同时捕捉时空图的时空相关性，图形时空网络的目标可以是预测未来的节点值或标签，或者预测时空图标签。


## 0x2 图的类型

### 有向图（Directed graphs）

+ 有向边相对与无向边来说能够表达更为丰富的信息。要以不同的形式来对待父类和子类的信息传播过程，如ADGPM中使用两种不同的矩阵

### 异构图（ Heterogeneous Graphs）

+ 将每个节点的类型转换为一个与原始特征连接的热特征向量。
+ GraphInception 引入metapath，使得可以根据相邻节点的类型和距离对其进行分组。

### 带边的权重或类型图（Graph with Edge Information）

+ 将图转换为二分图，其中原始边也成为节点，并且将一个原始边拆分为两个新边，这意味着边节点和开始/结束节点之间有两个新边。

## 传播类型（Propagation Types）

> 使用不同的聚集器从每个节点的邻域收集信息，并指定更新器来更新节点的隐藏状态。

## 0x3 图神经网络的应用

+ 计算机视觉: 场景图生成、点云分类与分割、动作识别等
+ 推荐系统
+ 交通拥堵: 预测交通网络中的交通速度、交通量，进行路线规划和流量控制
+ 化学：研究分子的图结构，学习分子指纹、预测分子性质、推断蛋白质结构、合成化合物。

## 0x4 未来挑战

+ 浅层结构：目前GNN还只能在较浅层的网络上发挥优势，随着层数的加深，网络会出现退化。
+ 动态图：目前大多方法只能应用在静态图上，对于动态图还没有特别好的解决方案。
+ 非结构化场景：还没有一个通用的方法来合理的处理非结构化数据。
+ 扩展性：将图网络应用于大规模数据上仍然面临着不小的困难。
